<!DOCTYPE html>
<html lang="en-us">
<head>
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <script type="text/javascript" src="https://latest.cactus.chat/cactus.js"></script>
  <link rel="stylesheet" href="https://latest.cactus.chat/style.css" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> 第三方模块 | self-salvation</title>
  <link rel = 'canonical' href = 'https://jinkes-li.github.io/python/%E7%AC%AC%E4%B8%89%E6%96%B9%E6%A8%A1%E5%9D%97/'>
  
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="第三方模块" />
<meta property="og:description" content="python第三方模块 第三方模块指的是别人写的模块，一般情况下功能都是非常强大的 如果使用第三方模块第一次必须使用pip指令下载后才可以调用
第三方模块的下载方式
下载时可能会出现的问题
爬虫之requests模块
自动化办公openpyxl模块
第三方模块扩展(模块叠模块)
第三方模块的下载方式
1. pip工具， 每个版本的解释器都有pip工具，当电脑上存在多版本解释器时需要知道我们在使用哪一个，为了避免冲突，会在pip工具重新复制一份起别名 2. 在下载模块，使用命令下载 php3 install 模块名 3. 在下载模块时，默认仓库指向的是python的官网，如果下载太慢建议更改为国内 php3 install 模块名 -i 国内仓库地址 4. 在安装模块时，若不想使用最新的模块可以使用==来指定版本 php3 install 模块名==版本号 5. 在编写代码时，pycharm也提供了一些操作界面的安装方式，不太推荐使用，毕竟代码运行的平台大多数还是linux 安装时可能存在的问题 下载第三方模块可能会出现的问题 1.报错并有警告信息 WARNING: You are using pip version 20.2.1; 原因在于pip版本过低 只需要拷贝后面的命令执行更新操作即可 d:\python38\python.exe -m pip install --upgrade pip 更新完成后再次执行下载第三方模块的命令即可 2.报错并含有Timeout关键字 说明当前计算机网络不稳定 只需要换网或者重新执行几次即可 3.报错并没有关键字 面向百度搜索 pip下载XXX报错:拷贝错误信息 通常都是需要用户提前准备好一些环境才可以顺利下载 4.下载速度很慢 pip默认下载的仓库地址是国外的 python.org 我们可以切换下载的地址 pip install 模块名 -i 仓库地址 pip的仓库地址有很多 百度查询即可 清华大学 ：https://pypi.tuna.tsinghua.edu.cn/simple/ 阿里云：http://mirrors." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jinkes-li.github.io/python/%E7%AC%AC%E4%B8%89%E6%96%B9%E6%A8%A1%E5%9D%97/" /><meta property="article:section" content="python" />
<meta property="article:published_time" content="2022-10-26T20:22:04+08:00" />
<meta property="article:modified_time" content="2022-10-26T20:22:04+08:00" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="第三方模块"/>
<meta name="twitter:description" content="python第三方模块 第三方模块指的是别人写的模块，一般情况下功能都是非常强大的 如果使用第三方模块第一次必须使用pip指令下载后才可以调用
第三方模块的下载方式
下载时可能会出现的问题
爬虫之requests模块
自动化办公openpyxl模块
第三方模块扩展(模块叠模块)
第三方模块的下载方式
1. pip工具， 每个版本的解释器都有pip工具，当电脑上存在多版本解释器时需要知道我们在使用哪一个，为了避免冲突，会在pip工具重新复制一份起别名 2. 在下载模块，使用命令下载 php3 install 模块名 3. 在下载模块时，默认仓库指向的是python的官网，如果下载太慢建议更改为国内 php3 install 模块名 -i 国内仓库地址 4. 在安装模块时，若不想使用最新的模块可以使用==来指定版本 php3 install 模块名==版本号 5. 在编写代码时，pycharm也提供了一些操作界面的安装方式，不太推荐使用，毕竟代码运行的平台大多数还是linux 安装时可能存在的问题 下载第三方模块可能会出现的问题 1.报错并有警告信息 WARNING: You are using pip version 20.2.1; 原因在于pip版本过低 只需要拷贝后面的命令执行更新操作即可 d:\python38\python.exe -m pip install --upgrade pip 更新完成后再次执行下载第三方模块的命令即可 2.报错并含有Timeout关键字 说明当前计算机网络不稳定 只需要换网或者重新执行几次即可 3.报错并没有关键字 面向百度搜索 pip下载XXX报错:拷贝错误信息 通常都是需要用户提前准备好一些环境才可以顺利下载 4.下载速度很慢 pip默认下载的仓库地址是国外的 python.org 我们可以切换下载的地址 pip install 模块名 -i 仓库地址 pip的仓库地址有很多 百度查询即可 清华大学 ：https://pypi.tuna.tsinghua.edu.cn/simple/ 阿里云：http://mirrors."/>

  
  
    
  
  
  <link rel="stylesheet" href="https://jinkes-li.github.io/css/styles.94f653e9e151e28067a7c5dbbc4600cbd5a3c721e79faaf971e523c40f3b249b8e4f20bb57810dfffa8d559ca5c140fd56eb4cd9c0853113ad08e66afdb08bdd.css" integrity="sha512-lPZT6eFR4oBnp8XbvEYAy9WjxyHnn6r5ceUjxA87JJuOTyC7V4EN//qNVZylwUD9VutM2cCFMROtCOZq/bCL3Q=="> 

  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://jinkes-li.github.io/images/favicon.ico" />

  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

    <header id="header">
  <a href="https://jinkes-li.github.io/">
  
    <div id="logo" style="background-image: url(https://jinkes-li.github.io/images/logo.png)"></div>
  
  <div id="title">
    <h1>self-salvation</h1>
  </div>
  </a>
  <div id="nav">
    <ul>
      <li class="icon">
        <a href="#" aria-label="Menu"><i class="fas fa-bars fa-2x" aria-hidden="true"></i></a>
      </li>
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/posts/">All posts</a></li>
      
        <li><a href="/tags">Tags</a></li>
      
        <li><a href="/python">Python</a></li>
      
        <li><a href="/about">About</a></li>
      
    </ul>
  </div>
</header>



    
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <div class="content" itemprop="articleBody">
  
    <h3 id="python第三方模块">python第三方模块</h3>
<blockquote>
<p>第三方模块指的是别人写的模块，一般情况下功能都是非常强大的
如果使用第三方模块第一次必须使用pip指令下载后才可以调用</p>
</blockquote>
<ul>
<li>
<p>第三方模块的下载方式</p>
</li>
<li>
<p>下载时可能会出现的问题</p>
</li>
<li>
<p>爬虫之requests模块</p>
</li>
<li>
<p>自动化办公openpyxl模块</p>
</li>
<li>
<p>第三方模块扩展(模块叠模块)</p>
</li>
<li>
<p>第三方模块的下载方式</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ae81ff">1.</span> pip工具<span style="color:#960050;background-color:#1e0010">，</span> 每个版本的解释器都有pip工具<span style="color:#960050;background-color:#1e0010">，</span>当电脑上存在多版本解释器时需要知道我们在使用哪一个<span style="color:#960050;background-color:#1e0010">，</span>为了避免冲突<span style="color:#960050;background-color:#1e0010">，</span>会在pip工具重新复制一份起别名
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2.</span> 在下载模块<span style="color:#960050;background-color:#1e0010">，</span>使用命令下载
</span></span><span style="display:flex;"><span>	php3 install 模块名
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3.</span> 在下载模块时<span style="color:#960050;background-color:#1e0010">，</span>默认仓库指向的是python的官网<span style="color:#960050;background-color:#1e0010">，</span>如果下载太慢建议更改为国内
</span></span><span style="display:flex;"><span>	php3 install 模块名 <span style="color:#f92672">-</span>i 国内仓库地址
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4.</span> 在安装模块时<span style="color:#960050;background-color:#1e0010">，</span>若不想使用最新的模块可以使用<span style="color:#f92672">==</span>来指定版本
</span></span><span style="display:flex;"><span>	php3 install 模块名<span style="color:#f92672">==</span>版本号
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5.</span> 在编写代码时<span style="color:#960050;background-color:#1e0010">，</span>pycharm也提供了一些操作界面的安装方式<span style="color:#960050;background-color:#1e0010">，</span>不太推荐使用<span style="color:#960050;background-color:#1e0010">，</span>毕竟代码运行的平台大多数还是linux
</span></span></code></pre></div><ul>
<li>安装时可能存在的问题</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>下载第三方模块可能会出现的问题
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1.</span>报错并有警告信息
</span></span><span style="display:flex;"><span>		WARNING: You are using pip version <span style="color:#ae81ff">20.2.1</span>;
</span></span><span style="display:flex;"><span>		原因在于pip版本过低 只需要拷贝后面的命令执行更新操作即可
</span></span><span style="display:flex;"><span>		d:\python38\python<span style="color:#f92672">.</span>exe <span style="color:#f92672">-</span>m pip install <span style="color:#f92672">--</span>upgrade pip
</span></span><span style="display:flex;"><span>		更新完成后再次执行下载第三方模块的命令即可
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">2.</span>报错并含有Timeout关键字
</span></span><span style="display:flex;"><span>		说明当前计算机网络不稳定 只需要换网或者重新执行几次即可
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">3.</span>报错并没有关键字
</span></span><span style="display:flex;"><span>		面向百度搜索
</span></span><span style="display:flex;"><span>			pip下载XXX报错:拷贝错误信息
</span></span><span style="display:flex;"><span>		通常都是需要用户提前准备好一些环境才可以顺利下载
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">4.</span>下载速度很慢
</span></span><span style="display:flex;"><span>		pip默认下载的仓库地址是国外的 python<span style="color:#f92672">.</span>org
</span></span><span style="display:flex;"><span>		我们可以切换下载的地址
</span></span><span style="display:flex;"><span>		pip install 模块名 <span style="color:#f92672">-</span>i 仓库地址
</span></span><span style="display:flex;"><span>		pip的仓库地址有很多 百度查询即可
</span></span><span style="display:flex;"><span>		清华大学 <span style="color:#960050;background-color:#1e0010">：</span>https:<span style="color:#f92672">//</span>pypi<span style="color:#f92672">.</span>tuna<span style="color:#f92672">.</span>tsinghua<span style="color:#f92672">.</span>edu<span style="color:#f92672">.</span>cn<span style="color:#f92672">/</span>simple<span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span>		阿里云<span style="color:#960050;background-color:#1e0010">：</span>http:<span style="color:#f92672">//</span>mirrors<span style="color:#f92672">.</span>aliyun<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>pypi<span style="color:#f92672">/</span>simple<span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span>		中国科学技术大学 <span style="color:#960050;background-color:#1e0010">：</span>http:<span style="color:#f92672">//</span>pypi<span style="color:#f92672">.</span>mirrors<span style="color:#f92672">.</span>ustc<span style="color:#f92672">.</span>edu<span style="color:#f92672">.</span>cn<span style="color:#f92672">/</span>simple<span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span>		华中科技大学<span style="color:#960050;background-color:#1e0010">：</span>http:<span style="color:#f92672">//</span>pypi<span style="color:#f92672">.</span>hustunique<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span>		豆瓣源<span style="color:#960050;background-color:#1e0010">：</span>http:<span style="color:#f92672">//</span>pypi<span style="color:#f92672">.</span>douban<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>simple<span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span>		腾讯源<span style="color:#960050;background-color:#1e0010">：</span>http:<span style="color:#f92672">//</span>mirrors<span style="color:#f92672">.</span>cloud<span style="color:#f92672">.</span>tencent<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>pypi<span style="color:#f92672">/</span>simple
</span></span><span style="display:flex;"><span>		华为镜像源https:<span style="color:#f92672">//</span>repo<span style="color:#f92672">.</span>huaweicloud<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>repository<span style="color:#f92672">/</span>pypi<span style="color:#f92672">/</span>simple<span style="color:#f92672">/</span>
</span></span></code></pre></div><ul>
<li>爬虫之requests模块</li>
</ul>
<blockquote>
<p>requests 可以模拟浏览器发送网络请求</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># php3 install requests</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 朝制定网址发送请求页面的数据，相当于我们在浏览器上访问</span>
</span></span><span style="display:flex;"><span>res <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;http://www.redbull.com.cn/about/branch&#39;</span>)
</span></span><span style="display:flex;"><span>print(res<span style="color:#f92672">.</span>text)
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1. 这里使用text 拿到的是文本数据，默认会按照utf8编码.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">也可以使用res.encoding = &#39;utf8&#39;来指定编码
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">2. 若使用content打印，获取的是bytes类型的网页数据
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1.</span> 在请求头内将自己伪装成浏览器
</span></span><span style="display:flex;"><span>headers <span style="color:#960050;background-color:#1e0010">：</span>使用user<span style="color:#f92672">-</span>Agent
</span></span></code></pre></div><ul>
<li>网络爬虫获取某二手房数据</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span>res <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;https://sh.lianjia.com/ershoufang/huangpu/&#39;</span>)
</span></span><span style="display:flex;"><span>data <span style="color:#f92672">=</span> res<span style="color:#f92672">.</span>text
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(data)</span>
</span></span><span style="display:flex;"><span>home_list <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>findall(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;&lt;a class=&#34;&#34; href=&#34;.*?&#34; target=&#34;_blank&#34; data-log_index=&#34;.*?&#34;  data-el=&#34;ershoufang&#34; data-housecode=&#34;.*?&#34; data-is_focus=&#34;&#34; data-sl=&#34;&#34;&gt;(.*?)&lt;/a&gt;&#39;</span>,
</span></span><span style="display:flex;"><span>    data)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(home_list)</span>
</span></span><span style="display:flex;"><span>access <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>findall(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;&lt;a href=&#34;.*?&#34; target=&#34;_blank&#34; data-log_index=&#34;.*?&#34; data-el=&#34;region&#34;&gt;(.*?) &lt;/a&gt;&#39;</span>,
</span></span><span style="display:flex;"><span>    data)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(access)</span>
</span></span><span style="display:flex;"><span>Specific_address <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>findall(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;&lt;div class=&#34;positionInfo&#34;&gt;&lt;span class=&#34;positionIcon&#34;&gt;&lt;/span&gt;&lt;a href=&#34;.*?&#34; target=&#34;_blank&#34; data-log_index=&#34;.*?&#34; data-el=&#34;region&#34;&gt;.*? &lt;/a&gt;   -  &lt;a href=&#34;.*?&#34; target=&#34;_blank&#34;&gt;(.*?)&lt;/a&gt; &lt;/div&gt;&#39;</span>,
</span></span><span style="display:flex;"><span>    data)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(Specific_address)</span>
</span></span><span style="display:flex;"><span>home_info <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>findall(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;&lt;div class=&#34;houseInfo&#34;&gt;&lt;span class=&#34;houseIcon&#34;&gt;&lt;/span&gt;(.*?)&lt;/div&gt;&#39;</span>,
</span></span><span style="display:flex;"><span>    data)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(home_info)</span>
</span></span><span style="display:flex;"><span>follow <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>findall(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;&lt;div class=&#34;followInfo&#34;&gt;&lt;span class=&#34;starIcon&#34;&gt;&lt;/span&gt;(.*?)&lt;/div&gt;&#39;</span>,
</span></span><span style="display:flex;"><span>    data)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(follow)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>home_data <span style="color:#f92672">=</span> zip(home_list, access, Specific_address, home_info, follow)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;info.txt&#39;</span>, <span style="color:#e6db74">&#39;w&#39;</span>, encoding<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;utf8&#39;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> home_data:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        房屋简介：</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        房屋地址：</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">-</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        房屋信息：</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        房屋关注：</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;&#34;&#34;</span><span style="color:#f92672">%</span>i)
</span></span><span style="display:flex;"><span>        f<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        房屋简介：</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        房屋地址：</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">-</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        房屋信息：</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        房屋关注：</span><span style="color:#e6db74">%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;&#34;&#34;</span><span style="color:#f92672">%</span>i)
</span></span></code></pre></div><ul>
<li>python模块之openpyxl</li>
</ul>
<blockquote>
<p>这个表格主要用于操作Excel，主要是写数据比较方便，比如pandas模块就是封装了此模块
但是需要注意的是openpyxl是最近几年比较火的模块相对于03版本之前的excel后缀兼容很差</p>
</blockquote>
<blockquote>
<p>学习建议，强列推荐根据官方文档来学习这些第三方模块的使用</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> openpyxl <span style="color:#f92672">import</span> Workbook
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 创建一个excel文件</span>
</span></span><span style="display:flex;"><span>wb <span style="color:#f92672">=</span> Workbook()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 在一个excel文件中创建多个工作簿</span>
</span></span><span style="display:flex;"><span>wb1 <span style="color:#f92672">=</span> wb<span style="color:#f92672">.</span>create_sheet(<span style="color:#e6db74">&#39;富婆名单&#39;</span>)
</span></span><span style="display:flex;"><span>wb2 <span style="color:#f92672">=</span> wb<span style="color:#f92672">.</span>create_sheet(<span style="color:#e6db74">&#39;高富帅名单&#39;</span>)
</span></span><span style="display:flex;"><span>wb3 <span style="color:#f92672">=</span> wb<span style="color:#f92672">.</span>create_sheet(<span style="color:#e6db74">&#39;海王名单&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 可以更具索引修改工作簿sheet的位置</span>
</span></span><span style="display:flex;"><span>web <span style="color:#f92672">=</span> web<span style="color:#f92672">.</span>create_sheet(<span style="color:#e6db74">&#39;海王名单&#39;</span><span style="color:#960050;background-color:#1e0010">，</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 可以二次修改工作簿名称</span>
</span></span><span style="display:flex;"><span>wb4<span style="color:#f92672">.</span>title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;高富帅名单&#39;</span>
</span></span><span style="display:flex;"><span>wb4<span style="color:#f92672">.</span>sheet_properties<span style="color:#f92672">.</span>tabColor <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1072BA&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">——————————————————————</span>数据的填写<span style="color:#960050;background-color:#1e0010">——————————————————————</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 填写数据的方式1</span>
</span></span><span style="display:flex;"><span>wb4[<span style="color:#e6db74">&#39;F4&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">666</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 填写数据的方式2</span>
</span></span><span style="display:flex;"><span>wb4<span style="color:#f92672">.</span>call(row<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, column<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, calue<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;wesley&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 填写数据的方式3</span>
</span></span><span style="display:flex;"><span>wb4<span style="color:#f92672">.</span>append([<span style="color:#e6db74">&#39;编号&#39;</span><span style="color:#960050;background-color:#1e0010">，</span><span style="color:#e6db74">&#39;姓名&#39;</span><span style="color:#960050;background-color:#1e0010">，</span><span style="color:#e6db74">&#39;年龄&#39;</span><span style="color:#960050;background-color:#1e0010">，</span><span style="color:#e6db74">&#39;爱好&#39;</span>])  <span style="color:#75715e"># 表头字段</span>
</span></span><span style="display:flex;"><span>wb4<span style="color:#f92672">.</span>append([<span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;jason&#39;</span>, <span style="color:#e6db74">&#39;18&#39;</span>, <span style="color:#e6db74">&#39;read&#39;</span>])
</span></span><span style="display:flex;"><span>wb4<span style="color:#f92672">.</span>append([<span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39;wesley&#39;</span>, <span style="color:#e6db74">&#39;18&#39;</span>, <span style="color:#e6db74">&#39;music&#39;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">——————————————————————</span>填写数据公式<span style="color:#960050;background-color:#1e0010">——————————————————————</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>wb4<span style="color:#f92672">.</span>cell(row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, column<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,value<span style="color:#f92672">=</span><span style="color:#ae81ff">123</span>)
</span></span><span style="display:flex;"><span>wb4<span style="color:#f92672">.</span>cell(row<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, column<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,value<span style="color:#f92672">=</span><span style="color:#ae81ff">321</span>)
</span></span><span style="display:flex;"><span>wb4[<span style="color:#e6db74">&#39;A5&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;=sum(A1:A4)&#39;</span>
</span></span><span style="display:flex;"><span>wb4<span style="color:#f92672">.</span>cell(row<span style="color:#f92672">=</span><span style="color:#ae81ff">8</span>, column<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, value<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;=sum(A1:A4)&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 保存excel文件</span>
</span></span><span style="display:flex;"><span>wb<span style="color:#f92672">.</span>save(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;wesley_test.xlsx&#39;</span>)
</span></span></code></pre></div><p>扩展： openpyxl主要用于数据的写入，表的相关操作并不擅长，若对表单操作推荐pandas模块</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas
</span></span><span style="display:flex;"><span>data_dict <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#39;公司名称&#39;</span><span style="color:#960050;background-color:#1e0010">：</span>comp_title_list,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#39;公司地址&#39;</span>: comp_address_list,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#39;公司邮编&#39;</span>: comp_email_list,
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#39;公司电话&#39;</span>: comp_phone_list
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 将字典转化成pandas里面的DataFrame数据结构</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pandas<span style="color:#f92672">.</span>DataFrame(data_dict)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 直接保存成excel文件</span>
</span></span><span style="display:flex;"><span>df<span style="color:#f92672">.</span>to_excel(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;pd_comp_info.xlsx&#39;</span>)
</span></span></code></pre></div>
  
  </div>
</article>


    <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2022  self-salvation 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts/">All posts</a></li>
         
        <li><a href="/tags">Tags</a></li>
         
        <li><a href="/python">Python</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
</html>
